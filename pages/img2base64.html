<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›¾ç‰‡ â†” Base64 è½¬æ¢å·¥å…·</title>
  <style>
    :root {
      --primary-color: #4361ee;
      --secondary-color: #3f37c9;
      --success-color: #4cc9f0;
      --light-color: #f8f9fa;
      --dark-color: #212529;
      --border-radius: 12px;
      --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      line-height: 1.6;
      color: var(--dark-color);
      background-color: #f5f7ff;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin: 20px 0 40px;
      color: var(--primary-color);
      font-weight: 600;
      font-size: clamp(1.8rem, 4vw, 2.5rem);
    }

    .card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 25px;
      margin-bottom: 30px;
      transition: var(--transition);
    }

    .card:hover {
      box-shadow: 0 6px 25px rgba(0, 0, 0, 0.12);
    }

    .card h2 {
      color: var(--secondary-color);
      margin-bottom: 20px;
      font-size: 1.4rem;
      font-weight: 500;
    }

    .drag-area {
      border: 2px dashed var(--primary-color);
      border-radius: var(--border-radius);
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      background-color: rgba(67, 97, 238, 0.05);
      margin-bottom: 15px;
    }

    .drag-area:hover {
      background-color: rgba(67, 97, 238, 0.1);
    }

    .drag-area.dragover {
      background-color: rgba(67, 97, 238, 0.2);
      border-color: var(--secondary-color);
    }

    .drag-area .icon {
      font-size: 48px;
      color: var(--primary-color);
      margin-bottom: 15px;
    }

    .drag-area .text {
      font-size: 1.1rem;
      color: var(--dark-color);
      margin-bottom: 10px;
    }

    .drag-area .hint {
      font-size: 0.9rem;
      color: #6c757d;
    }

    textarea {
      width: 100%;
      min-height: 150px;
      padding: 15px;
      border: 1px solid #dee2e6;
      border-radius: var(--border-radius);
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.95rem;
      resize: vertical;
      transition: var(--transition);
    }

    textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    .btn {
      display: inline-block;
      padding: 12px 24px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 15px;
    }

    .btn:hover {
      background-color: var(--secondary-color);
      transform: translateY(-2px);
    }

    .btn-block {
      display: block;
      width: 100%;
    }

    .file-info {
      font-size: 0.9rem;
      color: #495057;
      margin: 10px 0;
      padding: 10px;
      background-color: var(--light-color);
      border-radius: 6px;
    }

    .preview-container {
      margin-top: 20px;
      text-align: center;
    }

    .preview-image {
      max-width: 100%;
      max-height: 300px;
      border-radius: var(--border-radius);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      display: none;
    }

    .download-btn {
      display: none;
      margin-top: 15px;
      background-color: var(--success-color);
    }

    .download-btn:hover {
      background-color: #38b6db;
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      .card {
        padding: 20px;
      }
      
      .drag-area {
        padding: 30px 15px;
      }
      
      .btn {
        padding: 10px 20px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }
      
      h1 {
        margin: 10px 0 30px;
      }
      
      .drag-area .icon {
        font-size: 36px;
      }
      
      .drag-area .text {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>å›¾ç‰‡ â†” Base64 è½¬æ¢å·¥å…·</h1>
    
    <div class="card">
      <h2>å›¾ç‰‡è½¬ Base64</h2>
      <div class="drag-area" id="dragArea">
        <div class="icon">ğŸ“</div>
        <div class="text">ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„</div>
        <div class="hint">æ”¯æŒ JPG, PNG, GIF ç­‰æ ¼å¼</div>
        <input type="file" id="fileInput" accept="image/*" hidden>
      </div>
      <div id="fileInfo" class="file-info"></div>
      <textarea id="base64Output" placeholder="ç”Ÿæˆçš„ Base64 ç¼–ç å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..." readonly></textarea>
      <button class="btn btn-block" onclick="copyBase64()">å¤åˆ¶ Base64 ç¼–ç </button>
      <div class="preview-container">
        <img id="previewImage" class="preview-image" alt="å›¾ç‰‡é¢„è§ˆ"/>
      </div>
    </div>
    
    <div class="card">
      <h2>Base64 è½¬å›¾ç‰‡</h2>
      <textarea id="base64Input" placeholder="åœ¨æ­¤ç²˜è´´ Base64 å›¾ç‰‡ç¼–ç ..."></textarea>
      <button class="btn btn-block" onclick="base64ToImage()">è½¬æ¢ä¸ºå›¾ç‰‡</button>
      <div class="preview-container">
        <img id="outputImage" class="preview-image" alt="ç”Ÿæˆçš„å›¾ç‰‡"/>
      </div>
      <button id="downloadLink" class="btn btn-block download-btn">ä¸‹è½½å›¾ç‰‡</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const fileInput = document.getElementById('fileInput');
      const dragArea = document.getElementById('dragArea');
      
      // ç‚¹å‡»æ‹–æ‹½åŒºåŸŸè§¦å‘æ–‡ä»¶é€‰æ‹©
      dragArea.addEventListener('click', () => fileInput.click());
      
      // æ‹–æ‹½å¤„ç†
      dragArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        dragArea.classList.add('dragover');
      });
      
      dragArea.addEventListener('dragleave', () => {
        dragArea.classList.remove('dragover');
      });
      
      dragArea.addEventListener('drop', (e) => {
        e.preventDefault();
        dragArea.classList.remove('dragover');
        if (e.dataTransfer.files.length) {
          processImageFile(e.dataTransfer.files[0]);
        }
      });
      
      // æ–‡ä»¶é€‰æ‹©å¤„ç†
      fileInput.addEventListener('change', () => {
        if (fileInput.files.length) {
          processImageFile(fileInput.files[0]);
        }
      });
      
      function processImageFile(file) {
        if (!file || !file.type.startsWith('image/')) {
          alert('è¯·é€‰æ‹©æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶ï¼');
          return;
        }
        
        const reader = new FileReader();
        reader.onload = (e) => {
          const base64Data = e.target.result;
          const previewImage = document.getElementById('previewImage');
          const fileInfo = document.getElementById('fileInfo');
          
          document.getElementById('base64Output').value = base64Data;
          previewImage.src = base64Data;
          previewImage.style.display = 'block';
          
          fileInfo.innerHTML = `
            <strong>${file.name}</strong><br>
            å¤§å°: ${(file.size / 1024).toFixed(1)} KB | 
            ç±»å‹: ${file.type} | 
            å°ºå¯¸: <span id="imageDimensions">è®¡ç®—ä¸­...</span>
          `;
          
          // è·å–å›¾ç‰‡å®é™…å°ºå¯¸
          const img = new Image();
          img.onload = function() {
            document.getElementById('imageDimensions').textContent = 
              `${this.width} Ã— ${this.height} åƒç´ `;
          };
          img.src = base64Data;
        };
        
        reader.onerror = () => {
          alert('è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•ï¼');
        };
        
        reader.readAsDataURL(file);
      }
    });
    
    function copyBase64() {
      const textArea = document.getElementById('base64Output');
      textArea.select();
      
      try {
        const successful = document.execCommand('copy');
        if (successful) {
          showToast('Base64 ç¼–ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        } else {
          throw new Error('å¤åˆ¶å¤±è´¥');
        }
      } catch (err) {
        // ä½¿ç”¨ç°ä»£ Clipboard API
        navigator.clipboard.writeText(textArea.value)
          .then(() => showToast('Base64 ç¼–ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼'))
          .catch(() => alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¹¶å¤åˆ¶æ–‡æœ¬ã€‚'));
      }
    }
    
    function base64ToImage() {
      const data = document.getElementById('base64Input').value.trim();
      if (!data) {
        showToast('è¯·è¾“å…¥Base64æ•°æ®ï¼', 'error');
        return;
      }
      
      if (!data.startsWith('data:image/')) {
        showToast('è¯·è¾“å…¥å®Œæ•´çš„Base64å›¾ç‰‡æ•°æ®ï¼ˆå¿…é¡»ä»¥"data:image/"å¼€å¤´ï¼‰', 'error');
        return;
      }
      
      const output = document.getElementById('outputImage');
      const downloadBtn = document.getElementById('downloadLink');
      
      output.onload = function() {
        output.style.display = 'block';
        downloadBtn.style.display = 'block';
      };
      
      output.onerror = function() {
        showToast('æ— æ•ˆçš„Base64å›¾ç‰‡æ•°æ®ï¼', 'error');
        output.style.display = 'none';
        downloadBtn.style.display = 'none';
      };
      
      output.src = data;
      downloadBtn.onclick = () => {
        const link = document.createElement('a');
        link.href = data;
        link.download = `image_${Date.now()}.${getImageExtension(data)}`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      };
    }
    
    function getImageExtension(base64Data) {
      const match = base64Data.match(/^data:image\/(\w+);/);
      return match ? match[1] : 'png';
    }
    
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.textContent = message;
      toast.style.position = 'fixed';
      toast.style.bottom = '20px';
      toast.style.left = '50%';
      toast.style.transform = 'translateX(-50%)';
      toast.style.padding = '12px 24px';
      toast.style.backgroundColor = type === 'error' ? '#ff4444' : '#4CAF50';
      toast.style.color = 'white';
      toast.style.borderRadius = '4px';
      toast.style.boxShadow = '0 2px 10px rgba(0,0,0,0.2)';
      toast.style.zIndex = '1000';
      toast.style.animation = 'fadeIn 0.3s, fadeOut 0.3s 2.7s';
      
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.style.animation = 'fadeOut 0.3s';
        setTimeout(() => document.body.removeChild(toast), 300);
      }, 3000);
    }
  </script>
</body>
</html>